
	INCLUDE	BIOS.INC
	INCLUDE	DATA.INC

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

	CSEG
	PUBLIC	GAME
	EXTRN	LEVELINIT,MOBINIT,MOVINIT,EDITOR,INITCHAR
	EXTRN	SETPAGE,NEWFRAME,KBHIT,CHARACTER,KPRESS

	INCLUDE	EVENT.INC

GAME:	CALL	MOBINIT
	CALL	MOVINIT
	CALL	LEVELINIT
	CALL	INITCHAR
	CALL	EDITOR

	EXTRN	EDLEVEL,EDROOM,FOCUSCAM,PLACE,USER

	XOR	A
	LD	(DPPAGE),A
	INC	A
	LD	(ACPAGE),A
	CALL	SETPAGE

	LD	DE,(EDLEVEL)
	LD	BC,(EDROOM)
	LD	(P1+POINT.LEVEL),DE
	LD	(P1+POINT.ROOM),BC
	CALL	FOCUSCAM

	LD	IX,CHR1
	LD	E,0
	LD	BC,USER
	CALL	CHARACTER
	LD	DE,P1
	LD	C,0
	CALL	PLACE

G.LOOP:	CALL	NEWFRAME
	LD	A,(FINISH)
	OR	A
	JR	Z,G.LOOP

	RET

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

	PUBLIC	ENGINE
	EXTRN	THINK,ANIMATE

ENGINE:	CALL	THINK
	CALL	ANIMATE
	RET

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

	DSEG
	PUBLIC	FINISH

FINISH:	DB	0
CHR1:	DS	SIZCHAR
P1:	DW	0,0
	DB	0,0,0

